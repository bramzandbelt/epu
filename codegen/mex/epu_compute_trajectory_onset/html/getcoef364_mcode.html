<pre class="code">
<span class="srcline"><span class="lineno"><a href="82,209" id="srcline209">209</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="82,210" id="srcline210">210</a></span><span class="line"><span class="comment">% =========================================================</span></span></span>
<span class="srcline"><span class="lineno"><a href="82,211" id="srcline211">211</a></span><span class="line"><span class="comment">% subfunction, used to compute the filter coefficients</span></span></span>
<span class="srcline"><span class="lineno"><a href="82,212" id="srcline212">212</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S29T2U354">coef</span> = <span class="message warning" id="M1F364C">getcoef</span>(<span class="var type1" id="S30T17U357">t</span>,<span class="var type1" id="S31T3U358">supportlength</span>,<span class="mxinfo" id="T3:U4"><span class="mxinfo" id="T3:U5"><span class="var type1" id="S32T3U359">modelorder</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="82,213" id="srcline213">213</a></span><span class="line"><span class="comment">% Note: bsxfun would have worked here as well, but some people</span></span></span>
<span class="srcline"><span class="lineno"><a href="82,214" id="srcline214">214</a></span><span class="line"><span class="comment">% might not yet have that release of matlab.</span></span></span>
<span class="srcline"><span class="lineno"><a href="82,215" id="srcline215">215</a></span><span class="line"><span class="mxinfo" id="T19:U7"><span class="var type1" id="S33T19U362">A</span> = <span class="mxinfo" id="T19:U9"><span class="mxinfo" id="T19:U10">repmat(<span class="var type1" id="S30T17U366">t</span>,1,<span class="var type1" id="S32T3U369">modelorder</span>+1)</span>.^<span class="mxinfo" id="T19:U13">repmat(0:<span class="var type1" id="S32T3U375">modelorder</span>,<span class="var type1" id="S31T3U376">supportlength</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="82,216" id="srcline216">216</a></span><span class="line"><span class="mxinfo" id="T23:U16"><span class="var type1" id="S35T23U380">pinvA</span> = <span class="mxinfo" id="T23:U18">pinv(<span class="var type1" id="S33T19U383">A</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="82,217" id="srcline217">217</a></span><span class="line"><span class="comment">% we only need the linear term</span></span></span>
<span class="srcline"><span class="lineno"><a href="82,218" id="srcline218">218</a></span><span class="line"><span class="mxinfo" id="T2:U20"><span class="var type1" id="S29T2U386">coef</span> = <span class="mxinfo" id="T2:U22"><span class="var type1" id="S35T23U388">pinvA</span>(<span class="mxinfo" id="T3:U24">2</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="82,219" id="srcline219">219</a></span><span class="line"><span class="keyword">end</span> <span class="comment">% nested function end</span></span></span>
</pre>
