<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T3U3">rt</span>,<span class="mxinfo" id="T23:U2"><span class="var type1" id="S3T23U4"><span class="message error" id="M1F1C">activation</span></span></span>] = epu_n_unit_ba(<span class="var type1" id="S4T1U7">v</span>,<span class="var type1" id="S5T1U8">theta</span>,<span class="var type1" id="S6T1U9">k</span>,<span class="var type1" id="S7T3U10">affTime</span>,<span class="var type1" id="S8T3U11">effTime</span>,<span class="var type1" id="S9T1U12">pN</span>,<span class="var type1" id="S10T3U13">dMeth</span>,<span class="var type1" id="S11T1U14">iAT</span>)  <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% EPU redundant ballistic accumulator model</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% INPUTS</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% v             - vector with accumulation rates across accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%                 * units:          spikes s-1 ms-1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1xnA double, where nA is number of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%                                   accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%                 * support:        v ? ?: (0,+?)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% theta         - vector with thresholds across accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%                 * units:          spikes s-1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1xnA double, where nA is number of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%                                   accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%                 * support:        theta ? ?: (0,+?)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% k             - vector with leakage parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%                 * units:          </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1xnA double, where nA is number of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%                                   accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%                 * support:        k ? ?: (0,+?)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">% affTime       - afferent (encoding) time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%                 * units:          ms</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1x1 double</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%                 * support:        affTime ? ?: [0,+?)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">% effTime       - efferent (response execution) time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%                 * units:          ms</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1x1 double</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%                 * support:        effTime ? ?: [0,+?)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">% pN            - proportion of accumulators necessary to produce an RT ('RT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%                 rule').</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%                 * units:          unitless</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1x1 double</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%                 * support:        pN ? ?: [0,1], where 0 means that the very</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%                 first accumulator reaching threshold produces RT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">% dMeth         - decision method, polling or pooling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%                 * units:          unitless</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1x1 double</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%                 * support:        * 1   polling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%                                   * 2   pooling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">% iAT           - accumulators indices for which to provide accumulation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%                 trajectories</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%                 * units:          unitless</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%                 * size &amp; class:   1xN double, where N is the number of indices</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%                 to get and N &lt;= nA, where nA is number of accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%                 * support:        iAT ? ?: [1,nA]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">% USAGE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">% [rt,activation] = epu_n_unit_ba(v,theta,k,affTime,effTime,pN,dMeth,iAT);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">% Bram Zandbelt, October 2012</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo" id="T3:U11"><span class="var type1" id="S2T3U17">rt</span> = <span class="mxinfo" id="T3:U13">Inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo" id="T3:U14"><span class="var type1" id="S13T3U22">accumulationTime</span> = <span class="mxinfo" id="T3:U16">Inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">% Number of accumulator units</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo" id="T3:U17"><span class="var type1" id="S14T3U27">nA</span> = <span class="mxinfo" id="T3:U19">size(<span class="var type1" id="S4T1U30">v</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo" id="T3:U21"><span class="var type1" id="S16T3U34">nAT</span> = <span class="mxinfo" id="T3:U23">numel(<span class="var type1" id="S11T1U37">iAT</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo" id="T3:U25"><span class="var type1" id="S18T3U40">x0</span> = <span class="mxinfo" id="T3:U27">0</span></span>;              <span class="comment">% Starting value of activation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">% Time to reach theta for each accumulator</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo" id="T2:U28"><span class="var type1" id="S19T2U44">dtAccumulation</span> = <span class="mxinfo" id="T2:U30"><span class="mxinfo" id="T2:U31">log(<span class="mxinfo" id="T2:U32">(<span class="mxinfo" id="T2:U33"><span class="var type1" id="S5T1U51">theta</span> - <span class="mxinfo" id="T2:U35"><span class="var type1" id="S4T1U53">v</span>./<span class="var type1" id="S6T1U54">k</span></span></span>)./(<span class="mxinfo" id="T2:U38"><span class="var type1" id="S18T3U57">x0</span> - <span class="mxinfo" id="T2:U40"><span class="var type1" id="S4T1U59">v</span>./<span class="var type1" id="S6T1U60">k</span></span></span>)</span>)</span>./<span class="mxinfo" id="T1:U43">-<span class="var type1" id="S6T1U62">k</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">% dtAccumulation = arrayfun(@log,(theta - v./k)./(x0 - v./k))./-k;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T9:U45"><span class="var type1" id="S10T3U66">dMeth</span> == <span class="mxinfo" id="T3:U47">1</span></span> <span class="comment">% Polling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T9:U48"><span class="var type1" id="S14T3U71">nA</span> &gt; <span class="mxinfo" id="T3:U50">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">      <span class="comment">% Per simulation, sort growth times in ascending order</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">      <span class="mxinfo" id="T2:U51"><span class="var type1" id="S19T2U75">dtAccumulation</span> = <span class="mxinfo" id="T2:U53"><span class="mxinfo" id="T10:U54">sort(<span class="mxinfo" id="T10:U55"><span class="var type1" id="S19T2U80">dtAccumulation</span>'</span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T9:U57">all(<span class="mxinfo" id="T30:U58"><span class="var type1" id="S9T1U86">pN</span> == <span class="mxinfo" id="T3:U60">0</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">      <span class="mxinfo" id="T1:U61"><span class="var type1" id="S9T1U90">pN</span> = <span class="mxinfo" id="T3:U63">realmin</span></span>; <span class="comment">% This ensures that very first accumulator determines RT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">   <span class="comment">% Compute rt as the sum of afferent time, time for pN fraction of accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">   <span class="comment">% to reach threshold and efferent time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">   <span class="mxinfo" id="T2:U64"><span class="var type1" id="S13T2U95">accumulationTime</span> = <span class="mxinfo" id="T2:U66"><span class="var type1" id="S19T2U97">dtAccumulation</span>(:,<span class="mxinfo" id="T10:U68">ceil(<span class="mxinfo" id="T2:U69"><span class="var type1" id="S9T1U102">pN</span>*<span class="var type1" id="S14T3U103">nA</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">   <span class="mxinfo" id="T3:U72"><span class="var type1" id="S13T3U106">accumulationTime</span> = <span class="mxinfo" id="T3:U74"><span class="var type1" id="S13T2U108">accumulationTime</span>(<span class="mxinfo" id="T3:U76">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">   <span class="comment">% Compute RT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">   <span class="mxinfo" id="T3:U77"><span class="var type1" id="S2T3U113">rt</span>(1) = <span class="mxinfo" id="T3:U79"><span class="mxinfo" id="T3:U80"><span class="var type1" id="S7T3U117">affTime</span> + <span class="var type1" id="S13T3U118">accumulationTime</span></span> + <span class="var type1" id="S8T3U119">effTime</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">   <span class="comment">% Maximum time for trajectories</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">   <span class="mxinfo" id="T3:U84"><span class="var type1" id="S25T3U122">tMax</span> = <span class="mxinfo" id="T3:U86">ceil(<span class="var type1" id="S2T3U125">rt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">   <span class="comment">% Time vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">   <span class="mxinfo" id="T2:U88"><span class="var type1" id="S26T2U128">t</span> = <span class="mxinfo" id="T2:U90">0:1:<span class="var type1" id="S25T3U133">tMax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">   <span class="comment">% Compute activation trajectories for all accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">   <span class="mxinfo" id="T23:U92"><span class="var type1" id="S3T23U136">activation</span> = <span class="mxinfo" id="T23:U94">[<span class="mxinfo" id="T23:U95">zeros(<span class="mxinfo" id="T3:U96">floor(<span class="var type1" id="S7T3U143">affTime</span>)</span>,<span class="var type1" id="S16T3U144">nAT</span>)</span>;<span class="mxinfo" id="T23:U99"><span class="mxinfo" id="T23:U100"><span class="mxinfo" id="T23:U101">repmat(<span class="mxinfo" id="T1:U102"><span class="var type1" id="S4T1U151">v</span>(<span class="var type1" id="S11T1U152">iAT</span>)</span>,<span class="mxinfo" id="T3:U105"><span class="var type1" id="S25T3U154">tMax</span>+<span class="mxinfo" id="T3:U107">1</span></span>,1)</span>./<span class="mxinfo" id="T23:U108">repmat(<span class="mxinfo" id="T1:U109"><span class="var type1" id="S6T1U160">k</span>(<span class="var type1" id="S11T1U161">iAT</span>)</span>,<span class="mxinfo" id="T3:U112"><span class="var type1" id="S25T3U163">tMax</span>+<span class="mxinfo" id="T3:U114">1</span></span>,1)</span></span> + <span class="mxinfo" id="T23:U115">(<span class="mxinfo" id="T23:U116"><span class="mxinfo" id="T23:U117">repmat(<span class="var type1" id="S18T3U171">x0</span>,<span class="mxinfo" id="T3:U119"><span class="var type1" id="S25T3U173">tMax</span>+<span class="mxinfo" id="T3:U121">1</span></span>,<span class="var type1" id="S16T3U175">nAT</span>)</span> - <span class="mxinfo" id="T23:U123"><span class="mxinfo" id="T23:U124">repmat(<span class="mxinfo" id="T1:U125"><span class="var type1" id="S4T1U180">v</span>(<span class="var type1" id="S11T1U181">iAT</span>)</span>,<span class="mxinfo" id="T3:U128"><span class="var type1" id="S25T3U183">tMax</span>+<span class="mxinfo" id="T3:U130">1</span></span>,1)</span>./<span class="mxinfo" id="T23:U131">repmat(<span class="mxinfo" id="T1:U132"><span class="var type1" id="S6T1U189">k</span>(<span class="var type1" id="S11T1U190">iAT</span>)</span>,<span class="mxinfo" id="T3:U135"><span class="var type1" id="S25T3U192">tMax</span>+<span class="mxinfo" id="T3:U137">1</span></span>,1)</span></span></span>).*<span class="mxinfo" id="T23:U138">exp(<span class="mxinfo" id="T23:U139"><span class="mxinfo" id="T23:U140">repmat(<span class="mxinfo" id="T1:U141">-<span class="mxinfo" id="T1:U142"><span class="var type1" id="S6T1U202">k</span>(<span class="var type1" id="S11T1U203">iAT</span>)</span></span>,<span class="mxinfo" id="T3:U145"><span class="var type1" id="S25T3U205">tMax</span>+<span class="mxinfo" id="T3:U147">1</span></span>,1)</span>.*<span class="mxinfo" id="T23:U148">repmat(<span class="mxinfo" id="T10:U149"><span class="var type1" id="S26T2U211">t</span>'</span>,1,<span class="var type1" id="S16T3U213">nAT</span>)</span></span>)</span></span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T9:U152"><span class="var type1" id="S10T3U216">dMeth</span> == <span class="mxinfo" id="T3:U154">2</span></span> <span class="comment">% Pooling</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">   <span class="comment">% Maximum time to reach theta across the population</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">   <span class="mxinfo" id="T3:U155"><span class="var type1" id="S25T3U220">tMax</span> = <span class="mxinfo" id="T3:U157">ceil(<span class="mxinfo" id="T3:U158">max(<span class="var type1" id="S19T2U225">dtAccumulation</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">   <span class="comment">% Time vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">   <span class="mxinfo" id="T2:U160"><span class="var type1" id="S26T2U228">t</span> = <span class="mxinfo" id="T2:U162">0:1:<span class="var type1" id="S25T3U233">tMax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">   <span class="comment">% Compute activation trajectories for all accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">   <span class="mxinfo" id="T23:U164"><span class="var type1" id="S3T23U236">activation</span> = <span class="mxinfo" id="T23:U166"><span class="mxinfo" id="T23:U167"><span class="mxinfo" id="T23:U168">repmat(<span class="var type1" id="S4T1U241">v</span>,<span class="mxinfo" id="T3:U170"><span class="var type1" id="S25T3U243">tMax</span>+<span class="mxinfo" id="T3:U172">1</span></span>,1)</span>./<span class="mxinfo" id="T23:U173">repmat(<span class="var type1" id="S6T1U248">k</span>,<span class="mxinfo" id="T3:U175"><span class="var type1" id="S25T3U250">tMax</span>+<span class="mxinfo" id="T3:U177">1</span></span>,1)</span></span> + <span class="mxinfo" id="T23:U178">(<span class="mxinfo" id="T23:U179"><span class="mxinfo" id="T23:U180">repmat(<span class="var type1" id="S18T3U258">x0</span>,<span class="mxinfo" id="T3:U182"><span class="var type1" id="S25T3U260">tMax</span>+<span class="mxinfo" id="T3:U184">1</span></span>,<span class="var type1" id="S14T3U262">nA</span>)</span> - <span class="mxinfo" id="T23:U186"><span class="mxinfo" id="T23:U187">repmat(<span class="var type1" id="S4T1U266">v</span>,<span class="mxinfo" id="T3:U189"><span class="var type1" id="S25T3U268">tMax</span>+<span class="mxinfo" id="T3:U191">1</span></span>,1)</span>./<span class="mxinfo" id="T23:U192">repmat(<span class="var type1" id="S6T1U273">k</span>,<span class="mxinfo" id="T3:U194"><span class="var type1" id="S25T3U275">tMax</span>+<span class="mxinfo" id="T3:U196">1</span></span>,1)</span></span></span>).*<span class="mxinfo" id="T23:U197">exp(<span class="mxinfo" id="T23:U198"><span class="mxinfo" id="T23:U199">repmat(<span class="mxinfo" id="T1:U200">-<span class="var type1" id="S6T1U284">k</span></span>,<span class="mxinfo" id="T3:U202"><span class="var type1" id="S25T3U286">tMax</span>+<span class="mxinfo" id="T3:U204">1</span></span>,1)</span>.*<span class="mxinfo" id="T23:U205">repmat(<span class="mxinfo" id="T10:U206"><span class="var type1" id="S26T2U292">t</span>'</span>,1,<span class="var type1" id="S14T3U294">nA</span>)</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">   <span class="comment">% Compute average activation trajectory across accumulators</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">   <span class="mxinfo" id="T10:U209"><span class="var type1" id="S32T10U297">meanActivation</span> = <span class="mxinfo" id="T10:U211">mean(<span class="var type1" id="S3T23U300">activation</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">   <span class="mxinfo" id="T3:U213"><span class="var type1" id="S13T3U304">accumulationTime</span> = <span class="mxinfo" id="T3:U215">interp1(<span class="var type1" id="S32T10U307">meanActivation</span>,<span class="var type1" id="S26T2U308">t</span>,<span class="mxinfo" id="T3:U218">mean(<span class="var type1" id="S5T1U311">theta</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">   <span class="comment">% Compute RT </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">   <span class="mxinfo" id="T3:U220"><span class="var type1" id="S2T3U315">rt</span>(1) = <span class="mxinfo" id="T3:U222"><span class="mxinfo" id="T3:U223"><span class="var type1" id="S7T3U319">affTime</span> + <span class="var type1" id="S13T3U320">accumulationTime</span></span> + <span class="var type1" id="S8T3U321">effTime</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">   <span class="comment">% Compute activation trajectories for all accumulators, including affTime</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">   <span class="comment">% time points</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">   <span class="mxinfo" id="T23:U227"><span class="var type1" id="S3T23U324">activation</span> = <span class="mxinfo" id="T23:U229">[<span class="mxinfo" id="T23:U230">zeros(<span class="mxinfo" id="T3:U231">floor(<span class="var type1" id="S7T3U331">affTime</span>)</span>,<span class="var type1" id="S14T3U332">nA</span>)</span>;<span class="var type1" id="S3T23U334">activation</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">   <span class="comment">% Maximum time for trajectories</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">   <span class="mxinfo" id="T3:U235"><span class="var type1" id="S25T3U337">tMax</span> = <span class="mxinfo" id="T3:U237">ceil(<span class="var type1" id="S2T3U340">rt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">   <span class="comment">% Only use activation trajectories of iAT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">   <span class="mxinfo" id="T23:U239"><span class="var type1" id="S3T23U343">activation</span> = <span class="mxinfo" id="T23:U241"><span class="var type1" id="S3T23U345">activation</span>(<span class="mxinfo" id="T10:U243"><span class="mxinfo" id="T3:U244">1</span>:<span class="mxinfo" id="T3:U245"><span class="var type1" id="S25T3U349">tMax</span>+1</span></span>,<span class="var type1" id="S11T1U351">iAT</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"></span></span>
</pre>
